<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CV Builder Pro - Template Modern ATS</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: #f0f2f5;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 400px 1fr;
            gap: 20px;
        }

        /* Editor Panel Styling */
        .editor-panel {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            height: fit-content;
            max-height: 90vh;
            overflow-y: auto;
            position: sticky;
            top: 20px;
        }

        .editor-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 2px solid #eef2f6;
        }

        .editor-header h2 {
            color: #1e293b;
            font-size: 24px;
            font-weight: 700;
        }

        .color-controls {
            background: #f8fafc;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 24px;
        }

        .color-row {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .color-row:last-child {
            margin-bottom: 0;
        }

        .color-row label {
            width: 120px;
            font-weight: 600;
            color: #475569;
        }

        .color-row input[type="color"] {
            width: 60px;
            height: 40px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            cursor: pointer;
        }

        .color-row input[type="text"] {
            flex: 1;
            padding: 8px 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 13px;
        }

        .tabs-modern {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-bottom: 24px;
        }

        .tab-modern {
            padding: 10px 16px;
            border: none;
            background: #f1f5f9;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 600;
            color: #475569;
            transition: all 0.3s;
            font-size: 13px;
        }

        .tab-modern.active {
            background: var(--primary-color, #2563eb);
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .section-card {
            background: #f8fafc;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .section-title {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            color: #1e293b;
            font-size: 16px;
            font-weight: 700;
        }

        .section-title i {
            color: var(--primary-color, #2563eb);
        }

        .form-group-modern {
            margin-bottom: 16px;
        }

        .form-group-modern label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            color: #475569;
            font-size: 13px;
        }

        .form-group-modern input,
        .form-group-modern textarea,
        .form-group-modern select {
            width: 100%;
            padding: 10px 14px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 14px;
            transition: all 0.3s;
        }

        .form-group-modern input:focus,
        .form-group-modern textarea:focus {
            border-color: var(--primary-color, #2563eb);
            outline: none;
        }

        .item-grid {
            display: grid;
            gap: 12px;
        }

        .item-card-modern {
            background: white;
            border-radius: 10px;
            padding: 16px;
            position: relative;
            border: 2px solid #e2e8f0;
            transition: all 0.3s;
        }

        .item-card-modern:hover {
            border-color: var(--primary-color, #2563eb);
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 8px;
        }

        .item-title {
            font-weight: 700;
            color: #1e293b;
        }

        .item-subtitle {
            font-size: 12px;
            color: #64748b;
        }

        .item-actions-modern {
            display: flex;
            gap: 6px;
        }

        .btn-icon-modern {
            width: 32px;
            height: 32px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            color: white;
            transition: all 0.3s;
        }

        .btn-edit-modern { background: #f59e0b; }
        .btn-delete-modern { background: #ef4444; }
        .btn-add-modern {
            background: var(--primary-color, #2563eb);
            color: white;
            padding: 12px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            width: 100%;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s;
        }

        .btn-add-modern:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }

        /* CV Preview Modern */
        .cv-preview-modern {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            position: sticky;
            top: 20px;
        }

        .cv-container-modern {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        /* Template Modern 1 - Professional */
        .cv-template-1 {
            --bg-primary: var(--primary-color, #2c3e50);
            --bg-secondary: var(--secondary-color, #34495e);
            --text-light: #ecf0f1;
            --text-dark: #2c3e50;
        }

        .cv-template-1 .cv-sidebar {
            background: var(--bg-primary);
            color: var(--text-light);
            padding: 30px 25px;
            height: 100%;
        }

        .cv-template-1 .cv-main {
            padding: 30px 25px;
            background: white;
        }

        .cv-template-1 .profile-name {
            font-size: 28px;
            font-weight: 800;
            margin-bottom: 5px;
            color: var(--text-light);
        }

        .cv-template-1 .profile-title {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }

        .cv-template-1 .contact-info {
            margin-bottom: 25px;
        }

        .cv-template-1 .contact-item {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
            font-size: 13px;
        }

        .cv-template-1 .contact-item i {
            width: 18px;
            font-size: 14px;
        }

        .cv-template-1 .section-title-sidebar {
            font-size: 16px;
            font-weight: 700;
            margin: 25px 0 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .cv-template-1 .skill-item-sidebar {
            margin-bottom: 12px;
        }

        .cv-template-1 .skill-name {
            font-size: 13px;
            margin-bottom: 4px;
        }

        .cv-template-1 .skill-bar {
            height: 6px;
            background: rgba(255,255,255,0.2);
            border-radius: 3px;
            overflow: hidden;
        }

        .cv-template-1 .skill-level {
            height: 100%;
            background: white;
            border-radius: 3px;
        }

        .cv-template-1 .main-section-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--bg-primary);
            margin-bottom: 20px;
            padding-bottom: 8px;
            border-bottom: 3px solid var(--bg-primary);
        }

        .cv-template-1 .experience-item-main {
            margin-bottom: 20px;
        }

        .cv-template-1 .exp-header-main {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            margin-bottom: 5px;
        }

        .cv-template-1 .exp-title-main {
            font-weight: 700;
            color: var(--text-dark);
        }

        .cv-template-1 .exp-company-main {
            font-weight: 600;
            color: #7f8c8d;
            font-size: 13px;
        }

        .cv-template-1 .exp-date-main {
            color: #95a5a6;
            font-size: 12px;
        }

        /* Template Modern 2 - Minimalist */
        .cv-template-2 {
            --accent-color: var(--primary-color, #3498db);
        }

        .cv-template-2 .cv-header-minimal {
            background: linear-gradient(135deg, var(--accent-color), #2980b9);
            color: white;
            padding: 40px 30px;
            text-align: center;
        }

        .cv-template-2 .name-minimal {
            font-size: 36px;
            font-weight: 800;
            margin-bottom: 10px;
        }

        .cv-template-2 .title-minimal {
            font-size: 18px;
            opacity: 0.9;
        }

        .cv-template-2 .contact-minimal {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-top: 25px;
            font-size: 14px;
        }

        .cv-template-2 .contact-minimal i {
            margin-right: 8px;
        }

        .cv-template-2 .cv-body-minimal {
            padding: 30px;
        }

        .cv-template-2 .section-minimal {
            margin-bottom: 25px;
        }

        .cv-template-2 .section-title-minimal {
            font-size: 20px;
            font-weight: 700;
            color: var(--accent-color);
            margin-bottom: 15px;
            padding-bottom: 5px;
            border-bottom: 2px solid var(--accent-color);
        }

        /* Template Modern 3 - Creative */
        .cv-template-3 {
            display: grid;
            grid-template-columns: 280px 1fr;
        }

        .cv-template-3 .sidebar-creative {
            background: var(--primary-color, #8e44ad);
            color: white;
            padding: 30px 20px;
        }

        .cv-template-3 .main-creative {
            padding: 30px;
            background: white;
        }

        .cv-template-3 .avatar-creative {
            width: 120px;
            height: 120px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            border: 3px solid white;
        }

        /* Print Styles */
        @media print {
            body { 
                background: white; 
                padding: 0;
                margin: 0;
            }
            
            .container { 
                display: block; 
                max-width: 100%;
                padding: 0;
            }
            
            .editor-panel, .tabs-modern, .btn-add-modern, 
            .item-actions-modern, .btn-icon-modern, .color-controls {
                display: none !important;
            }
            
            .cv-preview-modern {
                box-shadow: none;
                padding: 0;
                position: static;
            }
            
            .cv-container-modern {
                box-shadow: none;
                max-width: 100%;
                border-radius: 0;
            }

            .cv-template-1, .cv-template-2, .cv-template-3 {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
        }

        .template-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .template-btn {
            flex: 1;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            background: white;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .template-btn.active {
            border-color: var(--primary-color, #2563eb);
            background: var(--primary-color, #2563eb);
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Editor Panel -->
        <div class="editor-panel">
            <div class="editor-header">
                <h2><i class="fas fa-pen-fancy" style="color: var(--primary-color, #2563eb);"></i> CV Builder Pro</h2>
            </div>

            <!-- Color Controls -->
            <div class="color-controls">
                <h4 style="margin-bottom: 15px; color: #1e293b;"><i class="fas fa-palette"></i> Custom Colors</h4>
                <div class="color-row">
                    <label>Primary Color:</label>
                    <input type="color" id="primaryColor" value="#2563eb">
                    <input type="text" id="primaryColorHex" value="#2563eb" readonly>
                </div>
                <div class="color-row">
                    <label>Secondary Color:</label>
                    <input type="color" id="secondaryColor" value="#1e293b">
                    <input type="text" id="secondaryColorHex" value="#1e293b" readonly>
                </div>
                <div class="color-row">
                    <label>Background Color:</label>
                    <input type="color" id="bgColor" value="#ffffff">
                    <input type="text" id="bgColorHex" value="#ffffff" readonly>
                </div>
            </div>

            <!-- Template Selector -->
            <div class="template-selector">
                <button class="template-btn active" onclick="selectTemplate(1)">Professional</button>
                <button class="template-btn" onclick="selectTemplate(2)">Minimalist</button>
                <button class="template-btn" onclick="selectTemplate(3)">Creative</button>
            </div>

            <!-- Tabs -->
            <div class="tabs-modern">
                <button class="tab-modern active" data-tab="personal"><i class="fas fa-user"></i> Personal</button>
                <button class="tab-modern" data-tab="summary"><i class="fas fa-align-left"></i> Summary</button>
                <button class="tab-modern" data-tab="experience"><i class="fas fa-briefcase"></i> Experience</button>
                <button class="tab-modern" data-tab="education"><i class="fas fa-graduation-cap"></i> Education</button>
                <button class="tab-modern" data-tab="skills"><i class="fas fa-cog"></i> Skills</button>
                <button class="tab-modern" data-tab="additional"><i class="fas fa-plus-circle"></i> Additional</button>
            </div>

            <!-- Personal Tab -->
            <div class="tab-content active" id="personal-tab">
                <div class="section-card">
                    <div class="section-title">
                        <i class="fas fa-id-card"></i>
                        <span>Data Diri</span>
                    </div>
                    <div class="form-group-modern">
                        <label>Nama Lengkap</label>
                        <input type="text" id="fullName" value="Alexander Wijaya">
                    </div>
                    <div class="form-group-modern">
                        <label>Profesi/Judul</label>
                        <input type="text" id="profesi" value="Senior Full Stack Developer">
                    </div>
                    <div class="form-group-modern">
                        <label>Nomor Telepon</label>
                        <input type="text" id="phone" value="+62 812 3456 7890">
                    </div>
                    <div class="form-group-modern">
                        <label>Email</label>
                        <input type="email" id="email" value="alex.wijaya@email.com">
                    </div>
                    <div class="form-group-modern">
                        <label>Domisili</label>
                        <input type="text" id="location" value="Jakarta, Indonesia">
                    </div>
                    <div class="form-group-modern">
                        <label>Website/Portfolio</label>
                        <input type="text" id="website" value="alexwijaya.com">
                    </div>
                </div>
            </div>

            <!-- Summary Tab -->
            <div class="tab-content" id="summary-tab">
                <div class="section-card">
                    <div class="section-title">
                        <i class="fas fa-align-left"></i>
                        <span>Ringkasan Profesional</span>
                    </div>
                    <div class="form-group-modern">
                        <textarea id="summary" rows="6">Full Stack Developer dengan 6+ tahun pengalaman dalam membangun aplikasi web skalabel. Ahli dalam React, Node.js, dan arsitektur cloud. Memiliki track record dalam memimpin tim developer dan mengirimkan project tepat waktu. Berorientasi pada hasil dan selalu mengikuti perkembangan teknologi terbaru.</textarea>
                    </div>
                </div>
            </div>

            <!-- Experience Tab -->
            <div class="tab-content" id="experience-tab">
                <div class="section-card">
                    <div class="section-title">
                        <i class="fas fa-briefcase"></i>
                        <span>Pengalaman Kerja</span>
                    </div>
                    <div id="experience-list" class="item-grid"></div>
                    <button class="btn-add-modern" onclick="addExperience()">
                        <i class="fas fa-plus"></i> Tambah Pengalaman
                    </button>
                </div>
            </div>

            <!-- Education Tab -->
            <div class="tab-content" id="education-tab">
                <div class="section-card">
                    <div class="section-title">
                        <i class="fas fa-graduation-cap"></i>
                        <span>Pendidikan</span>
                    </div>
                    <div id="education-list" class="item-grid"></div>
                    <button class="btn-add-modern" onclick="addEducation()">
                        <i class="fas fa-plus"></i> Tambah Pendidikan
                    </button>
                </div>
            </div>

            <!-- Skills Tab -->
            <div class="tab-content" id="skills-tab">
                <div class="section-card">
                    <div class="section-title">
                        <i class="fas fa-code"></i>
                        <span>Hard Skills</span>
                    </div>
                    <div id="hard-skills-list" class="item-grid"></div>
                    <button class="btn-add-modern" onclick="addHardSkill()">
                        <i class="fas fa-plus"></i> Tambah Hard Skill
                    </button>
                </div>

                <div class="section-card">
                    <div class="section-title">
                        <i class="fas fa-users"></i>
                        <span>Soft Skills</span>
                    </div>
                    <div id="soft-skills-list" class="item-grid"></div>
                    <button class="btn-add-modern" onclick="addSoftSkill()">
                        <i class="fas fa-plus"></i> Tambah Soft Skill
                    </button>
                </div>

                <div class="section-card">
                    <div class="section-title">
                        <i class="fas fa-tools"></i>
                        <span>Tools & Technologies</span>
                    </div>
                    <div id="tools-list" class="item-grid"></div>
                    <button class="btn-add-modern" onclick="addTool()">
                        <i class="fas fa-plus"></i> Tambah Tool
                    </button>
                </div>
            </div>

            <!-- Additional Tab -->
            <div class="tab-content" id="additional-tab">
                <div class="section-card">
                    <div class="section-title">
                        <i class="fas fa-certificate"></i>
                        <span>Sertifikasi</span>
                    </div>
                    <div id="certification-list" class="item-grid"></div>
                    <button class="btn-add-modern" onclick="addCertification()">
                        <i class="fas fa-plus"></i> Tambah Sertifikasi
                    </button>
                </div>

                <div class="section-card">
                    <div class="section-title">
                        <i class="fas fa-language"></i>
                        <span>Bahasa</span>
                    </div>
                    <div id="language-list" class="item-grid"></div>
                    <button class="btn-add-modern" onclick="addLanguage()">
                        <i class="fas fa-plus"></i> Tambah Bahasa
                    </button>
                </div>

                <div class="section-card">
                    <div class="section-title">
                        <i class="fas fa-heart"></i>
                        <span>Minat & Lainnya</span>
                    </div>
                    <div id="interest-list" class="item-grid"></div>
                    <button class="btn-add-modern" onclick="addInterest()">
                        <i class="fas fa-plus"></i> Tambah Minat
                    </button>
                </div>
            </div>

            <div style="margin-top: 20px; display: flex; gap: 10px;">
                <button onclick="saveCV()" class="btn-add-modern" style="flex: 1;">
                    <i class="fas fa-save"></i> Simpan CV
                </button>
                <button onclick="printCV()" class="btn-add-modern" style="flex: 1; background: #10b981;">
                    <i class="fas fa-print"></i> Print PDF
                </button>
            </div>
        </div>

        <!-- CV Preview -->
        <div class="cv-preview-modern" id="cvPreview">
            <div class="cv-container-modern" id="cvContent">
                <!-- Content akan diisi JavaScript -->
            </div>
        </div>
    </div>

    <script>
        // State management
        let currentTemplate = 1;
        let cvData = {
            personal: {
                name: 'Alexander Wijaya',
                profesi: 'Senior Full Stack Developer',
                phone: '+62 812 3456 7890',
                email: 'alex.wijaya@email.com',
                location: 'Jakarta, Indonesia',
                website: 'alexwijaya.com'
            },
            summary: 'Full Stack Developer dengan 6+ tahun pengalaman dalam membangun aplikasi web skalabel. Ahli dalam React, Node.js, dan arsitektur cloud. Memiliki track record dalam memimpin tim developer dan mengirimkan project tepat waktu. Berorientasi pada hasil dan selalu mengikuti perkembangan teknologi terbaru.',
            experiences: [
                { id: 1, title: 'Senior Full Stack Developer', company: 'Tech Innovate Indonesia', startDate: '2021', endDate: 'Sekarang', description: 'Memimpin tim developer dalam pengembangan aplikasi enterprise. Meningkatkan performa aplikasi sebesar 40%.' },
                { id: 2, title: 'Web Developer', company: 'Digital Solutions', startDate: '2018', endDate: '2021', description: 'Mengembangkan berbagai aplikasi web menggunakan React dan Node.js. Berkolaborasi dengan tim desain untuk UI/UX.' }
            ],
            educations: [
                { id: 1, degree: 'S1 Teknik Informatika', institution: 'Universitas Indonesia', graduationYear: '2018', gpa: '3.78' },
                { id: 2, degree: 'SMA IPA', institution: 'SMA Negeri 1 Jakarta', graduationYear: '2014', gpa: '' }
            ],
            hardSkills: [
                { id: 1, name: 'React.js', icon: 'fa-brands fa-react', level: 90 },
                { id: 2, name: 'Node.js', icon: 'fa-brands fa-node', level: 85 },
                { id: 3, name: 'JavaScript', icon: 'fa-brands fa-js', level: 95 },
                { id: 4, name: 'Python', icon: 'fa-brands fa-python', level: 80 }
            ],
            softSkills: [
                { id: 1, name: 'Komunikasi', level: 90 },
                { id: 2, name: 'Team Leadership', level: 85 },
                { id: 3, name: 'Problem Solving', level: 95 },
                { id: 4, name: 'Time Management', level: 88 }
            ],
            tools: [
                { id: 1, name: 'VS Code', icon: 'fa-solid fa-code' },
                { id: 2, name: 'Git', icon: 'fa-brands fa-git-alt' },
                { id: 3, name: 'Docker', icon: 'fa-brands fa-docker' },
                { id: 4, name: 'Figma', icon: 'fa-brands fa-figma' }
            ],
            certifications: [
                { id: 1, name: 'AWS Certified Developer', issuer: 'Amazon', year: '2023' },
                { id: 2, name: 'Google Cloud Professional', issuer: 'Google', year: '2022' }
            ],
            languages: [
                { id: 1, name: 'Bahasa Indonesia', level: 'Native' },
                { id: 2, name: 'Inggris', level: 'Professional' },
                { id: 3, name: 'Jepang', level: 'Basic' }
            ],
            interests: [
                { id: 1, icon: 'fa-solid fa-robot', text: 'AI & Machine Learning' },
                { id: 2, icon: 'fa-solid fa-book', text: 'Tech Blogging' },
                { id: 3, icon: 'fa-solid fa-bicycle', text: 'Cycling' }
            ]
        };

        // Color management
        document.getElementById('primaryColor').addEventListener('input', (e) => {
            document.getElementById('primaryColorHex').value = e.target.value;
            document.documentElement.style.setProperty('--primary-color', e.target.value);
            updatePreview();
        });

        document.getElementById('secondaryColor').addEventListener('input', (e) => {
            document.getElementById('secondaryColorHex').value = e.target.value;
            document.documentElement.style.setProperty('--secondary-color', e.target.value);
            updatePreview();
        });

        document.getElementById('bgColor').addEventListener('input', (e) => {
            document.getElementById('bgColorHex').value = e.target.value;
            document.documentElement.style.setProperty('--bg-color', e.target.value);
            updatePreview();
        });

        // Template selection
        function selectTemplate(templateNum) {
            currentTemplate = templateNum;
            document.querySelectorAll('.template-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            updatePreview();
        }

        // Tab switching
        document.querySelectorAll('.tab-modern').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.tab-modern').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                btn.classList.add('active');
                document.getElementById(`${btn.dataset.tab}-tab`).classList.add('active');
            });
        });

        // Form inputs
        document.getElementById('fullName').addEventListener('input', (e) => {
            cvData.personal.name = e.target.value;
            updatePreview();
        });

        document.getElementById('profesi').addEventListener('input', (e) => {
            cvData.personal.profesi = e.target.value;
            updatePreview();
        });

        document.getElementById('phone').addEventListener('input', (e) => {
            cvData.personal.phone = e.target.value;
            updatePreview();
        });

        document.getElementById('email').addEventListener('input', (e) => {
            cvData.personal.email = e.target.value;
            updatePreview();
        });

        document.getElementById('location').addEventListener('input', (e) => {
            cvData.personal.location = e.target.value;
            updatePreview();
        });

        document.getElementById('website').addEventListener('input', (e) => {
            cvData.personal.website = e.target.value;
            updatePreview();
        });

        document.getElementById('summary').addEventListener('input', (e) => {
            cvData.summary = e.target.value;
            updatePreview();
        });

        // CRUD Functions
        function addExperience() {
            const newExp = {
                id: Date.now(),
                title: 'Posisi Baru',
                company: 'Perusahaan',
                startDate: '2024',
                endDate: 'Sekarang',
                description: 'Deskripsi pekerjaan dan pencapaian'
            };
            cvData.experiences.push(newExp);
            renderExperienceList();
            updatePreview();
        }

        function editExperience(id) {
            const exp = cvData.experiences.find(e => e.id === id);
            if (exp) {
                const newTitle = prompt('Edit Posisi:', exp.title);
                if (newTitle) exp.title = newTitle;
                const newCompany = prompt('Edit Perusahaan:', exp.company);
                if (newCompany) exp.company = newCompany;
                const newStart = prompt('Edit Tahun Mulai:', exp.startDate);
                if (newStart) exp.startDate = newStart;
                const newEnd = prompt('Edit Tahun Selesai:', exp.endDate);
                if (newEnd) exp.endDate = newEnd;
                const newDesc = prompt('Edit Deskripsi:', exp.description);
                if (newDesc) exp.description = newDesc;
                renderExperienceList();
                updatePreview();
            }
        }

        function deleteExperience(id) {
            if (confirm('Hapus pengalaman ini?')) {
                cvData.experiences = cvData.experiences.filter(e => e.id !== id);
                renderExperienceList();
                updatePreview();
            }
        }

        function addEducation() {
            const newEdu = {
                id: Date.now(),
                degree: 'Jurusan Baru',
                institution: 'Institusi',
                graduationYear: '2024',
                gpa: '3.50'
            };
            cvData.educations.push(newEdu);
            renderEducationList();
            updatePreview();
        }

        function editEducation(id) {
            const edu = cvData.educations.find(e => e.id === id);
            if (edu) {
                const newDegree = prompt('Edit Jurusan:', edu.degree);
                if (newDegree) edu.degree = newDegree;
                const newInst = prompt('Edit Institusi:', edu.institution);
                if (newInst) edu.institution = newInst;
                const newYear = prompt('Edit Tahun Lulus:', edu.graduationYear);
                if (newYear) edu.graduationYear = newYear;
                const newGPA = prompt('Edit IPK (kosongkan jika < 3.0):', edu.gpa);
                if (newGPA !== null) edu.gpa = newGPA;
                renderEducationList();
                updatePreview();
            }
        }

        function deleteEducation(id) {
            if (confirm('Hapus pendidikan ini?')) {
                cvData.educations = cvData.educations.filter(e => e.id !== id);
                renderEducationList();
                updatePreview();
            }
        }

        function addHardSkill() {
            const newSkill = {
                id: Date.now(),
                name: 'Skill Baru',
                icon: 'fa-solid fa-code',
                level: 80
            };
            cvData.hardSkills.push(newSkill);
            renderHardSkillsList();
            updatePreview();
        }

        function editHardSkill(id) {
            const skill = cvData.hardSkills.find(s => s.id === id);
            if (skill) {
                const newName = prompt('Edit Nama Skill:', skill.name);
                if (newName) skill.name = newName;
                const newIcon = prompt('Edit Icon (contoh: fa-brands fa-react):', skill.icon);
                if (newIcon) skill.icon = newIcon;
                const newLevel = prompt('Edit Level (0-100):', skill.level);
                if (newLevel) skill.level = parseInt(newLevel);
                renderHardSkillsList();
                updatePreview();
            }
        }

        function deleteHardSkill(id) {
            if (confirm('Hapus hard skill ini?')) {
                cvData.hardSkills = cvData.hardSkills.filter(s => s.id !== id);
                renderHardSkillsList();
                updatePreview();
            }
        }

        function addSoftSkill() {
            const newSkill = {
                id: Date.now(),
                name: 'Soft Skill Baru',
                level: 85
            };
            cvData.softSkills.push(newSkill);
            renderSoftSkillsList();
            updatePreview();
        }

        function editSoftSkill(id) {
            const skill = cvData.softSkills.find(s => s.id === id);
            if (skill) {
                const newName = prompt('Edit Nama Soft Skill:', skill.name);
                if (newName) skill.name = newName;
                const newLevel = prompt('Edit Level (0-100):', skill.level);
                if (newLevel) skill.level = parseInt(newLevel);
                renderSoftSkillsList();
                updatePreview();
            }
        }

        function deleteSoftSkill(id) {
            if (confirm('Hapus soft skill ini?')) {
                cvData.softSkills = cvData.softSkills.filter(s => s.id !== id);
                renderSoftSkillsList();
                updatePreview();
            }
        }

        function addTool() {
            const newTool = {
                id: Date.now(),
                name: 'Tool Baru',
                icon: 'fa-solid fa-toolbox'
            };
            cvData.tools.push(newTool);
            renderToolsList();
            updatePreview();
        }

        function editTool(id) {
            const tool = cvData.tools.find(t => t.id === id);
            if (tool) {
                const newName = prompt('Edit Nama Tool:', tool.name);
                if (newName) tool.name = newName;
                const newIcon = prompt('Edit Icon (contoh: fa-brands fa-git):', tool.icon);
                if (newIcon) tool.icon = newIcon;
                renderToolsList();
                updatePreview();
            }
        }

        function deleteTool(id) {
            if (confirm('Hapus tool ini?')) {
                cvData.tools = cvData.tools.filter(t => t.id !== id);
                renderToolsList();
                updatePreview();
            }
        }

        function addCertification() {
            const newCert = {
                id: Date.now(),
                name: 'Sertifikasi Baru',
                issuer: 'Institusi',
                year: '2024'
            };
            cvData.certifications.push(newCert);
            renderCertificationList();
            updatePreview();
        }

        function editCertification(id) {
            const cert = cvData.certifications.find(c => c.id === id);
            if (cert) {
                const newName = prompt('Edit Nama Sertifikasi:', cert.name);
                if (newName) cert.name = newName;
                const newIssuer = prompt('Edit Penerbit:', cert.issuer);
                if (newIssuer) cert.issuer = newIssuer;
                const newYear = prompt('Edit Tahun:', cert.year);
                if (newYear) cert.year = newYear;
                renderCertificationList();
                updatePreview();
            }
        }

        function deleteCertification(id) {
            if (confirm('Hapus sertifikasi ini?')) {
                cvData.certifications = cvData.certifications.filter(c => c.id !== id);
                renderCertificationList();
                updatePreview();
            }
        }

        function addLanguage() {
            const newLang = {
                id: Date.now(),
                name: 'Bahasa Baru',
                level: 'Intermediate'
            };
            cvData.languages.push(newLang);
            renderLanguageList();
            updatePreview();
        }

        function editLanguage(id) {
            const lang = cvData.languages.find(l => l.id === id);
            if (lang) {
                const newName = prompt('Edit Nama Bahasa:', lang.name);
                if (newName) lang.name = newName;
                const newLevel = prompt('Edit Level (Native/Professional/Intermediate/Basic):', lang.level);
                if (newLevel) lang.level = newLevel;
                renderLanguageList();
                updatePreview();
            }
        }

        function deleteLanguage(id) {
            if (confirm('Hapus bahasa ini?')) {
                cvData.languages = cvData.languages.filter(l => l.id !== id);
                renderLanguageList();
                updatePreview();
            }
        }

        function addInterest() {
            const newInterest = {
                id: Date.now(),
                icon: 'fa-solid fa-star',
                text: 'Minat baru'
            };
            cvData.interests.push(newInterest);
            renderInterestList();
            updatePreview();
        }

        function editInterest(id) {
            const interest = cvData.interests.find(i => i.id === id);
            if (interest) {
                const newIcon = prompt('Edit Icon:', interest.icon);
                if (newIcon) interest.icon = newIcon;
                const newText = prompt('Edit Teks:', interest.text);
                if (newText) interest.text = newText;
                renderInterestList();
                updatePreview();
            }
        }

        function deleteInterest(id) {
            if (confirm('Hapus minat ini?')) {
                cvData.interests = cvData.interests.filter(i => i.id !== id);
                renderInterestList();
                updatePreview();
            }
        }

        // Render functions
        function renderExperienceList() {
            const container = document.getElementById('experience-list');
            container.innerHTML = cvData.experiences.map(exp => `
                <div class="item-card-modern">
                    <div class="item-header">
                        <div>
                            <div class="item-title">${exp.title}</div>
                            <div class="item-subtitle">${exp.company}</div>
                        </div>
                        <div class="item-actions-modern">
                            <button class="btn-icon-modern btn-edit-modern" onclick="editExperience(${exp.id})"><i class="fas fa-edit"></i></button>
                            <button class="btn-icon-modern btn-delete-modern" onclick="deleteExperience(${exp.id})"><i class="fas fa-trash"></i></button>
                        </div>
                    </div>
                    <div style="font-size: 11px; color: #64748b; margin: 5px 0;">
                        ${exp.startDate} - ${exp.endDate}
                    </div>
                    <div style="font-size: 12px; color: #475569;">
                        ${exp.description.substring(0, 60)}...
                    </div>
                </div>
            `).join('');
        }

        function renderEducationList() {
            const container = document.getElementById('education-list');
            container.innerHTML = cvData.educations.map(edu => `
                <div class="item-card-modern">
                    <div class="item-header">
                        <div>
                            <div class="item-title">${edu.degree}</div>
                            <div class="item-subtitle">${edu.institution}</div>
                        </div>
                        <div class="item-actions-modern">
                            <button class="btn-icon-modern btn-edit-modern" onclick="editEducation(${edu.id})"><i class="fas fa-edit"></i></button>
                            <button class="btn-icon-modern btn-delete-modern" onclick="deleteEducation(${edu.id})"><i class="fas fa-trash"></i></button>
                        </div>
                    </div>
                    <div style="font-size: 11px; color: #64748b;">
                        ${edu.graduationYear} ${edu.gpa && parseFloat(edu.gpa) >= 3.0 ? `| IPK: ${edu.gpa}` : ''}
                    </div>
                </div>
            `).join('');
        }

        function renderHardSkillsList() {
            const container = document.getElementById('hard-skills-list');
            container.innerHTML = cvData.hardSkills.map(skill => `
                <div class="item-card-modern">
                    <div class="item-header">
                        <div>
                            <div class="item-title"><i class="${skill.icon}"></i> ${skill.name}</div>
                            <div class="item-subtitle">Level: ${skill.level}%</div>
                        </div>
                        <div class="item-actions-modern">
                            <button class="btn-icon-modern btn-edit-modern" onclick="editHardSkill(${skill.id})"><i class="fas fa-edit"></i></button>
                            <button class="btn-icon-modern btn-delete-modern" onclick="deleteHardSkill(${skill.id})"><i class="fas fa-trash"></i></button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function renderSoftSkillsList() {
            const container = document.getElementById('soft-skills-list');
            container.innerHTML = cvData.softSkills.map(skill => `
                <div class="item-card-modern">
                    <div class="item-header">
                        <div>
                            <div class="item-title"><i class="fas fa-user-check"></i> ${skill.name}</div>
                            <div class="item-subtitle">Level: ${skill.level}%</div>
                        </div>
                        <div class="item-actions-modern">
                            <button class="btn-icon-modern btn-edit-modern" onclick="editSoftSkill(${skill.id})"><i class="fas fa-edit"></i></button>
                            <button class="btn-icon-modern btn-delete-modern" onclick="deleteSoftSkill(${skill.id})"><i class="fas fa-trash"></i></button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function renderToolsList() {
            const container = document.getElementById('tools-list');
            container.innerHTML = cvData.tools.map(tool => `
                <div class="item-card-modern">
                    <div class="item-header">
                        <div>
                            <div class="item-title"><i class="${tool.icon}"></i> ${tool.name}</div>
                        </div>
                        <div class="item-actions-modern">
                            <button class="btn-icon-modern btn-edit-modern" onclick="editTool(${tool.id})"><i class="fas fa-edit"></i></button>
                            <button class="btn-icon-modern btn-delete-modern" onclick="deleteTool(${tool.id})"><i class="fas fa-trash"></i></button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function renderCertificationList() {
            const container = document.getElementById('certification-list');
            container.innerHTML = cvData.certifications.map(cert => `
                <div class="item-card-modern">
                    <div class="item-header">
                        <div>
                            <div class="item-title"><i class="fas fa-certificate"></i> ${cert.name}</div>
                            <div class="item-subtitle">${cert.issuer} - ${cert.year}</div>
                        </div>
                        <div class="item-actions-modern">
                            <button class="btn-icon-modern btn-edit-modern" onclick="editCertification(${cert.id})"><i class="fas fa-edit"></i></button>
                            <button class="btn-icon-modern btn-delete-modern" onclick="deleteCertification(${cert.id})"><i class="fas fa-trash"></i></button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function renderLanguageList() {
            const container = document.getElementById('language-list');
            container.innerHTML = cvData.languages.map(lang => `
                <div class="item-card-modern">
                    <div class="item-header">
                        <div>
                            <div class="item-title"><i class="fas fa-language"></i> ${lang.name}</div>
                            <div class="item-subtitle">${lang.level}</div>
                        </div>
                        <div class="item-actions-modern">
                            <button class="btn-icon-modern btn-edit-modern" onclick="editLanguage(${lang.id})"><i class="fas fa-edit"></i></button>
                            <button class="btn-icon-modern btn-delete-modern" onclick="deleteLanguage(${lang.id})"><i class="fas fa-trash"></i></button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function renderInterestList() {
            const container = document.getElementById('interest-list');
            container.innerHTML = cvData.interests.map(interest => `
                <div class="item-card-modern">
                    <div class="item-header">
                        <div>
                            <div class="item-title"><i class="${interest.icon}"></i> ${interest.text}</div>
                        </div>
                        <div class="item-actions-modern">
                            <button class="btn-icon-modern btn-edit-modern" onclick="editInterest(${interest.id})"><i class="fas fa-edit"></i></button>
                            <button class="btn-icon-modern btn-delete-modern" onclick="deleteInterest(${interest.id})"><i class="fas fa-trash"></i></button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function updatePreview() {
            const cvContent = document.getElementById('cvContent');
            const primaryColor = document.getElementById('primaryColor').value;
            const secondaryColor = document.getElementById('secondaryColor').value;
            const bgColor = document.getElementById('bgColor').value;

            let templateHTML = '';

            if (currentTemplate === 1) {
                // Template Professional
                templateHTML = `
                    <div class="cv-template-1" style="display: grid; grid-template-columns: 280px 1fr; background: ${bgColor};">
                        <div class="cv-sidebar" style="background: ${primaryColor};">
                            <div class="profile-name">${cvData.personal.name}</div>
                            <div class="profile-title">${cvData.personal.profesi}</div>
                            
                            <div class="contact-info">
                                <div class="contact-item"><i class="fas fa-phone"></i> ${cvData.personal.phone}</div>
                                <div class="contact-item"><i class="fas fa-envelope"></i> ${cvData.personal.email}</div>
                                <div class="contact-item"><i class="fas fa-map-marker-alt"></i> ${cvData.personal.location}</div>
                                <div class="contact-item"><i class="fas fa-globe"></i> ${cvData.personal.website}</div>
                            </div>

                            <div class="section-title-sidebar">Hard Skills</div>
                            ${cvData.hardSkills.map(skill => `
                                <div class="skill-item-sidebar">
                                    <div class="skill-name"><i class="${skill.icon}"></i> ${skill.name}</div>
                                    <div class="skill-bar">
                                        <div class="skill-level" style="width: ${skill.level}%; background: white;"></div>
                                    </div>
                                </div>
                            `).join('')}

                            <div class="section-title-sidebar">Soft Skills</div>
                            ${cvData.softSkills.map(skill => `
                                <div class="skill-item-sidebar">
                                    <div class="skill-name"><i class="fas fa-user-check"></i> ${skill.name}</div>
                                    <div class="skill-bar">
                                        <div class="skill-level" style="width: ${skill.level}%; background: white;"></div>
                                    </div>
                                </div>
                            `).join('')}

                            <div class="section-title-sidebar">Tools</div>
                            <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                                ${cvData.tools.map(tool => `
                                    <span style="background: rgba(255,255,255,0.2); padding: 4px 10px; border-radius: 15px; font-size: 11px;">
                                        <i class="${tool.icon}"></i> ${tool.name}
                                    </span>
                                `).join('')}
                            </div>

                            <div class="section-title-sidebar">Bahasa</div>
                            ${cvData.languages.map(lang => `
                                <div class="skill-item-sidebar">
                                    <div class="skill-name"><i class="fas fa-language"></i> ${lang.name}</div>
                                    <div style="font-size: 11px; opacity: 0.8;">${lang.level}</div>
                                </div>
                            `).join('')}
                        </div>

                        <div class="cv-main" style="background: ${bgColor};">
                            <div class="main-section-title">Ringkasan Profil</div>
                            <div style="font-size: 13px; line-height: 1.6; margin-bottom: 25px; color: #2c3e50;">
                                ${cvData.summary}
                            </div>

                            <div class="main-section-title">Pengalaman Kerja</div>
                            ${cvData.experiences.map(exp => `
                                <div class="experience-item-main">
                                    <div class="exp-header-main">
                                        <div>
                                            <span class="exp-title-main">${exp.title}</span><br>
                                            <span class="exp-company-main">${exp.company}</span>
                                        </div>
                                        <div class="exp-date-main">${exp.startDate} - ${exp.endDate}</div>
                                    </div>
                                    <div style="font-size: 12px; color: #7f8c8d; margin-top: 5px;">${exp.description}</div>
                                </div>
                            `).join('')}

                            <div class="main-section-title">Pendidikan</div>
                            ${cvData.educations.map(edu => `
                                <div class="experience-item-main">
                                    <div class="exp-header-main">
                                        <div>
                                            <span class="exp-title-main">${edu.degree}</span><br>
                                            <span class="exp-company-main">${edu.institution}</span>
                                        </div>
                                        <div class="exp-date-main">${edu.graduationYear}</div>
                                    </div>
                                    ${edu.gpa && parseFloat(edu.gpa) >= 3.0 ? `<div style="font-size: 12px; color: #7f8c8d;">IPK: ${edu.gpa}</div>` : ''}
                                </div>
                            `).join('')}

                            <div class="main-section-title">Sertifikasi</div>
                            <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 20px;">
                                ${cvData.certifications.map(cert => `
                                    <span style="background: #f1f5f9; padding: 5px 12px; border-radius: 20px; font-size: 12px;">
                                        <i class="fas fa-certificate" style="color: ${primaryColor};"></i> ${cert.name}
                                    </span>
                                `).join('')}
                            </div>

                            <div class="main-section-title">Minat</div>
                            <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                                ${cvData.interests.map(interest => `
                                    <span style="background: #f1f5f9; padding: 5px 12px; border-radius: 20px; font-size: 12px;">
                                        <i class="${interest.icon}" style="color: ${primaryColor};"></i> ${interest.text}
                                    </span>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;
            } else if (currentTemplate === 2) {
                // Template Minimalist
                templateHTML = `
                    <div class="cv-template-2" style="background: ${bgColor};">
                        <div class="cv-header-minimal" style="background: linear-gradient(135deg, ${primaryColor}, ${secondaryColor});">
                            <div class="name-minimal">${cvData.personal.name}</div>
                            <div class="title-minimal">${cvData.personal.profesi}</div>
                            <div class="contact-minimal">
                                <span><i class="fas fa-phone"></i> ${cvData.personal.phone}</span>
                                <span><i class="fas fa-envelope"></i> ${cvData.personal.email}</span>
                                <span><i class="fas fa-map-marker-alt"></i> ${cvData.personal.location}</span>
                            </div>
                        </div>
                        
                        <div class="cv-body-minimal">
                            <div class="section-minimal">
                                <div class="section-title-minimal" style="color: ${primaryColor}; border-bottom-color: ${primaryColor};">Profile</div>
                                <div style="font-size: 14px; line-height: 1.6;">${cvData.summary}</div>
                            </div>

                            <div class="section-minimal">
                                <div class="section-title-minimal" style="color: ${primaryColor}; border-bottom-color: ${primaryColor};">Experience</div>
                                ${cvData.experiences.map(exp => `
                                    <div style="margin-bottom: 15px;">
                                        <div style="display: flex; justify-content: space-between;">
                                            <strong>${exp.title}</strong>
                                            <span style="color: #666;">${exp.startDate} - ${exp.endDate}</span>
                                        </div>
                                        <div style="color: ${primaryColor}; font-weight: 600; margin: 3px 0;">${exp.company}</div>
                                        <div style="font-size: 13px;">${exp.description}</div>
                                    </div>
                                `).join('')}
                            </div>

                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                                <div class="section-minimal">
                                    <div class="section-title-minimal" style="color: ${primaryColor}; border-bottom-color: ${primaryColor};">Skills</div>
                                    <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                                        ${cvData.hardSkills.map(skill => `
                                            <span style="background: ${primaryColor}10; color: ${primaryColor}; padding: 5px 12px; border-radius: 20px; font-size: 12px;">
                                                <i class="${skill.icon}"></i> ${skill.name}
                                            </span>
                                        `).join('')}
                                    </div>
                                </div>

                                <div class="section-minimal">
                                    <div class="section-title-minimal" style="color: ${primaryColor}; border-bottom-color: ${primaryColor};">Education</div>
                                    ${cvData.educations.map(edu => `
                                        <div style="margin-bottom: 10px;">
                                            <strong>${edu.degree}</strong><br>
                                            <span style="color: #666;">${edu.institution} | ${edu.graduationYear}</span>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            } else if (currentTemplate === 3) {
                // Template Creative
                templateHTML = `
                    <div class="cv-template-3" style="background: ${bgColor};">
                        <div class="sidebar-creative" style="background: ${primaryColor};">
                            <div class="avatar-creative">
                                <i class="fas fa-user-circle"></i>
                            </div>
                            <div style="text-align: center; margin-bottom: 25px;">
                                <div style="font-size: 22px; font-weight: 700;">${cvData.personal.name}</div>
                                <div style="font-size: 14px; opacity: 0.9;">${cvData.personal.profesi}</div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <div style="font-weight: 600; margin-bottom: 10px;"><i class="fas fa-address-card"></i> Kontak</div>
                                <div style="font-size: 12px; margin-bottom: 8px;"><i class="fas fa-phone"></i> ${cvData.personal.phone}</div>
                                <div style="font-size: 12px; margin-bottom: 8px;"><i class="fas fa-envelope"></i> ${cvData.personal.email}</div>
                                <div style="font-size: 12px; margin-bottom: 8px;"><i class="fas fa-map-marker-alt"></i> ${cvData.personal.location}</div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <div style="font-weight: 600; margin-bottom: 10px;"><i class="fas fa-code"></i> Tech Stack</div>
                                <div style="display: flex; flex-wrap: wrap; gap: 5px;">
                                    ${cvData.hardSkills.map(skill => `
                                        <span style="background: rgba(255,255,255,0.2); padding: 3px 8px; border-radius: 12px; font-size: 10px;">
                                            ${skill.name}
                                        </span>
                                    `).join('')}
                                </div>
                            </div>

                            <div>
                                <div style="font-weight: 600; margin-bottom: 10px;"><i class="fas fa-heart"></i> Interests</div>
                                ${cvData.interests.map(interest => `
                                    <div style="font-size: 12px; margin-bottom: 5px;">
                                        <i class="${interest.icon}"></i> ${interest.text}
                                    </div>
                                `).join('')}
                            </div>
                        </div>

                        <div class="main-creative">
                            <div style="margin-bottom: 25px;">
                                <h3 style="color: ${primaryColor}; margin-bottom: 10px;">About Me</h3>
                                <p style="font-size: 13px; line-height: 1.6;">${cvData.summary}</p>
                            </div>

                            <div style="margin-bottom: 25px;">
                                <h3 style="color: ${primaryColor}; margin-bottom: 10px;">Work Experience</h3>
                                ${cvData.experiences.map(exp => `
                                    <div style="margin-bottom: 15px;">
                                        <div style="display: flex; justify-content: space-between;">
                                            <strong>${exp.title}</strong>
                                            <span style="color: #666; font-size: 12px;">${exp.startDate} - ${exp.endDate}</span>
                                        </div>
                                        <div style="color: ${primaryColor}; margin: 3px 0;">${exp.company}</div>
                                        <div style="font-size: 12px;">${exp.description}</div>
                                    </div>
                                `).join('')}
                            </div>

                            <div style="margin-bottom: 25px;">
                                <h3 style="color: ${primaryColor}; margin-bottom: 10px;">Education</h3>
                                ${cvData.educations.map(edu => `
                                    <div style="margin-bottom: 10px;">
                                        <strong>${edu.degree}</strong><br>
                                        <span style="color: #666;">${edu.institution} | ${edu.graduationYear}</span>
                                    </div>
                                `).join('')}
                            </div>

                            <div>
                                <h3 style="color: ${primaryColor}; margin-bottom: 10px;">Certifications</h3>
                                ${cvData.certifications.map(cert => `
                                    <div style="margin-bottom: 5px; font-size: 13px;">
                                        <i class="fas fa-check-circle" style="color: ${primaryColor};"></i> ${cert.name} (${cert.issuer} - ${cert.year})
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;
            }

            cvContent.innerHTML = templateHTML;
        }

        function saveCV() {
            const fileName = `${cvData.personal.name.replace(/\s+/g, '_')}_CV.json`;
            const dataStr = JSON.stringify(cvData, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = fileName;
            a.click();
            alert('CV berhasil disimpan!');
        }

        function printCV() {
            window.print();
        }

        // Initial render
        renderExperienceList();
        renderEducationList();
        renderHardSkillsList();
        renderSoftSkillsList();
        renderToolsList();
        renderCertificationList();
        renderLanguageList();
        renderInterestList();
        updatePreview();
    </script>
</body>
</html>